<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="600" fill="#f8fafc"/>

  <!-- Title -->
  <text x="450" y="35" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#1e293b" text-anchor="middle">Current Transform Architecture</text>
  <text x="450" y="55" font-family="system-ui, sans-serif" font-size="12" fill="#ef4444" text-anchor="middle">Problems: Scattered refs, raw value pass-through, all images sent to LLM</text>

  <!-- Experience Steps Section -->
  <rect x="30" y="80" width="200" height="200" rx="8" fill="#e0f2fe" stroke="#0284c7" stroke-width="2"/>
  <text x="130" y="105" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#0369a1" text-anchor="middle">Experience Steps</text>

  <rect x="45" y="120" width="170" height="35" rx="4" fill="white" stroke="#0284c7"/>
  <text x="130" y="142" font-family="system-ui, sans-serif" font-size="11" fill="#1e293b" text-anchor="middle">petStep: "cat"</text>

  <rect x="45" y="165" width="170" height="35" rx="4" fill="white" stroke="#0284c7"/>
  <text x="130" y="187" font-family="system-ui, sans-serif" font-size="11" fill="#1e293b" text-anchor="middle">bgStep: "hobbiton"</text>

  <rect x="45" y="210" width="170" height="35" rx="4" fill="white" stroke="#0284c7"/>
  <text x="130" y="232" font-family="system-ui, sans-serif" font-size="11" fill="#1e293b" text-anchor="middle">captureStep: [photo]</text>

  <!-- Variable Mappings (Old) -->
  <rect x="280" y="80" width="260" height="200" rx="8" fill="#fef3c7" stroke="#d97706" stroke-width="2"/>
  <text x="410" y="105" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#b45309" text-anchor="middle">variableMappings (Mixed)</text>

  <rect x="295" y="120" width="230" height="50" rx="4" fill="white" stroke="#d97706"/>
  <text x="410" y="138" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b" text-anchor="middle">pet: { type: "answer", stepId }</text>
  <text x="410" y="155" font-family="system-ui, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">No value transformation!</text>

  <rect x="295" y="180" width="230" height="50" rx="4" fill="white" stroke="#d97706"/>
  <text x="410" y="198" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b" text-anchor="middle">photo: { type: "capturedMedia" }</text>
  <text x="410" y="215" font-family="system-ui, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">Mixed with text variables</text>

  <!-- AI Image Node -->
  <rect x="590" y="80" width="280" height="200" rx="8" fill="#fce7f3" stroke="#db2777" stroke-width="2"/>
  <text x="730" y="105" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#be185d" text-anchor="middle">AI Image Node</text>

  <rect x="605" y="120" width="250" height="70" rx="4" fill="white" stroke="#db2777"/>
  <text x="730" y="140" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b" text-anchor="middle">references: [</text>
  <text x="730" y="155" font-family="system-ui, sans-serif" font-size="9" fill="#ef4444" text-anchor="middle">cat, dog, chicken, hobbiton, rivendell...</text>
  <text x="730" y="170" font-family="system-ui, sans-serif" font-size="10" fill="#ef4444" text-anchor="middle">] ALL images attached statically!</text>

  <rect x="605" y="200" width="250" height="35" rx="4" fill="white" stroke="#db2777"/>
  <text x="730" y="222" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b" text-anchor="middle">promptTemplate: "...{{pet}}..."</text>

  <!-- LLM Section -->
  <rect x="280" y="320" width="340" height="140" rx="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="450" y="345" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#dc2626" text-anchor="middle">LLM Request (Inefficient)</text>

  <text x="300" y="375" font-family="system-ui, sans-serif" font-size="11" fill="#1e293b">Prompt: "...cat..." (raw value, no enrichment)</text>
  <text x="300" y="400" font-family="system-ui, sans-serif" font-size="11" fill="#ef4444">Images: ALL 9 reference images sent</text>
  <text x="300" y="425" font-family="system-ui, sans-serif" font-size="11" fill="#ef4444">LLM must figure out which to use</text>
  <text x="300" y="450" font-family="system-ui, sans-serif" font-size="11" fill="#ef4444">Higher cost, unpredictable results</text>

  <!-- Arrows -->
  <line x1="230" y1="180" x2="275" y2="180" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="540" y1="180" x2="585" y2="180" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="450" y1="285" x2="450" y2="315" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowhead-red)"/>

  <!-- Problem Callouts -->
  <rect x="30" y="480" width="260" height="100" rx="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="160" y="505" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" fill="#dc2626" text-anchor="middle">Problem 1: No Value Transformation</text>
  <text x="45" y="530" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">"cat" passed directly to prompt</text>
  <text x="45" y="550" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">Can't enrich to "cat from ref image"</text>
  <text x="45" y="570" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">Can't vary sentence structure</text>

  <rect x="320" y="480" width="260" height="100" rx="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="450" y="505" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" fill="#dc2626" text-anchor="middle">Problem 2: All Images Sent</text>
  <text x="335" y="530" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">9 images defined, only 3 needed</text>
  <text x="335" y="550" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">Increased token cost</text>
  <text x="335" y="570" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">LLM confused by irrelevant images</text>

  <rect x="610" y="480" width="260" height="100" rx="8" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="740" y="505" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" fill="#dc2626" text-anchor="middle">Problem 3: Mixed Concerns</text>
  <text x="625" y="530" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">Text vars and media in same place</text>
  <text x="625" y="550" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">Unclear mental model</text>
  <text x="625" y="570" font-family="system-ui, sans-serif" font-size="10" fill="#1e293b">Hard to manage at scale</text>
</svg>